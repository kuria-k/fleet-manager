<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Dashboard</title>
  </head>
  <style>
    .mydash {
      position: relative;
    }

    .myheader {
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 10;
    }

    .sign {
      display: none;
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      color: rgb(0, 0, 182);
      border: 2px solid #333;
      padding: 9px;
      font-size: 25px;
      text-align: center;
      z-index: 1000;
    }

    .yess {
      background-color: rgb(0, 0, 182);
      color: white;
      padding: 0.1em;
      border-radius: 0%;
      width: 50%;
    }

    .noo {
      background-color: rgb(0, 0, 182);
      color: white;
      padding: 0.1em;
      border-radius: 0%;
      width: 50%;
    }
  </style>

  <body>
    <nav
      class="fixed top-0 z-50 w-full bg-white border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700"
    >
      <div class="px-3 py-3 lg:px-5 lg:pl-3">
        <div class="flex items-center justify-between">
          <div class="flex items-center justify-start rtl:justify-end">
            <button
              data-drawer-target="logo-sidebar"
              data-drawer-toggle="logo-sidebar"
              aria-controls="logo-sidebar"
              type="button"
              class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg sm:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
            >
              <span class="sr-only">Open sidebar</span>
              <svg
                class="w-6 h-6"
                aria-hidden="true"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  clip-rule="evenodd"
                  fill-rule="evenodd"
                  d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z"
                ></path>
              </svg>
            </button>
            <a
              class="flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0"
            >
              <div>
                <img
                  src="pulsefleet-logo.png"
                  alt=""
                  class="w-10 h-10 p-none rounded-full"
                />
              </div>
              <span class="ml-3 text-xl"
                >Fleet
                <span class="text-blue-800 font-bold text-2xl"
                  >Pulse</span
                ></span
              >
            </a>
          </div>
          <nav
            class="md:ml-auto flex flex-wrap items-center text-base justify-center"
          >
            <a
              href="index.html"
              id="home"
              class="mr-5 p-2 rounded-2xl transition-transform duration-300 ease-in-out hover:-translate-y-2"
              >Home</a
            >
            <a
              href="manager.html"
              class="mr-5 p-2 rounded-2xl duration-300 ease-in-out hover:-translate-y-2 text-gray-100 bg-blue-700"
              >Fleet manager</a
            >
            <!-- <a href="login.html"
              class="mr-5 rounded-2xl transition-transform duration-300 ease-in-out hover:-translate-y-2"
              >Sign-out</a
            > -->
            <a href="login.html">
              <button
                id="signout"
                class="inline-flex items-center bg-gray-100 border-0 py-1 px-3 focus:outline-none hover:bg-gray-200 rounded text-base mt-4 md:mt-0"
              >
                Sign-out
                <svg
                  fill="none"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  class="w-4 h-4 ml-1"
                  viewBox="0 0 24 24"
                >
                  <path d="M5 12h14M12 5l7 7-7 7"></path>
                </svg>
              </button>
            </a>
          </nav>
        </div>
      </div>
    </nav>
    <br />
    <div id="confirm" class="sign">
      <p>Are you sure you want to sign out?</p>
      <button id="yesBtn" class="yess">Yes</button><br /><br />
      <button id="noBtn" class="noo">No</button>
    </div>

    <aside
      id="logo-sidebar"
      class="fixed top-0 left-0 z-40 w-64 h-screen pt-20 transition-transform -translate-x-full bg-white border-r border-gray-200 sm:translate-x-0 dark:bg-gray-800 dark:border-gray-700"
      aria-label="Sidebar"
    >
      <div class="h-full px-3 pb-4 overflow-y-auto bg-white dark:bg-gray-800">
        <ul class="space-y-2 font-medium">
          <li>
            <a
              href="dashboard.html"
              class="flex items-center p-2 text-gray-100 rounded-lg dark:text-white bg-blue-700 group"
            >
              <svg
                class="w-5 h-5 text-gray-900 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 22 21"
              >
                <path
                  d="M16.975 11H10V4.025a1 1 0 0 0-1.066-.998 8.5 8.5 0 1 0 9.039 9.039.999.999 0 0 0-1-1.066h.002Z"
                />
                <path
                  d="M12.5 0c-.157 0-.311.01-.565.027A1 1 0 0 0 11 1.02V10h8.975a1 1 0 0 0 1-.935c.013-.188.028-.374.028-.565A8.51 8.51 0 0 0 12.5 0Z"
                />
              </svg>
              <span class="ms-3">Dashboard</span>
            </a>
          </li>
          <li>
            <a
              href="add.html"
              class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
            >
              <div class="w-5 h-5">
                <img src="plus.png" alt="" />
              </div>
              <span class="flex-1 ms-3 whitespace-nowrap">Add rider</span>
              <span
                class="inline-flex items-center justify-center px-2 ms-3 text-sm font-medium text-gray-800 bg-gray-100 rounded-full dark:bg-gray-700 dark:text-gray-300"
              ></span>
            </a>
          </li>
          <li>
            <a
              href="assign.html"
              class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
            >
              <div class="w-5 h-5">
                <img src="delivery-man.png" alt="" />
              </div>
              <span class="flex-1 ms-3 whitespace-nowrap">Assign delivery</span>
              <span
                class="inline-flex items-center justify-center w-3 h-3 p-3 ms-3 text-sm font-medium text-blue-800 bg-blue-100 rounded-full dark:bg-blue-900 dark:text-blue-300"
                >3</span
              >
            </a>
          </li>
          <li>
            <a
              href="report.html"
              class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
            >
              <div class="w-5 h-5">
                <img src="data-analytics.png" alt="" />
              </div>
              <span class="flex-1 ms-3 whitespace-nowrap">Generate report</span>
            </a>
          </li>
          <li>
            <a
              href="#"
              class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
            >
              <div class="w-5 h-5">
                <img src="track.png" alt="" />
              </div>
              <span class="flex-1 ms-3 whitespace-nowrap">Track rider</span>
            </a>
          </li>
          <li>
            <a
              href="expense.html"
              class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
            >
              <div class="w-5 h-5">
                <img src="cash-flow.png" alt="" />
              </div>
              <span class="flex-1 ms-3 whitespace-nowrap"
                >Expense from bikes</span
              >
            </a>
          </li>
          <li></li>
          <li>
            <a
              href="maintainance.html"
              class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
            >
              <div class="w-5 h-5">
                <img src="tools.png" alt="" />
              </div>
              <span class="flex-1 ms-3 whitespace-nowrap"
                >Sheduled maintainance</span
              >
            </a>
          </li>
        </ul>
      </div>
    </aside>
    <br /><br /><br /><br />
    <div class="w-full max-w-4xl mx-auto mt-10">
      <h2 class="text-center text-4xl font-bold mb-6">
        Total Riders:
        <span id="totalRiders" class="text-blue-700 font-bold">0</span>
      </h2>

      <div class="w-full h-[400px]">
        <canvas id="riderChart" class="w-full h-full"></canvas>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="dashboard.js"></script>
  </body>

  <script>
    window.addEventListener("DOMContentLoaded", () => {
      // fetching my local storage/
      const riders = JSON.parse(localStorage.getItem("riders")) || [];

      
      document.getElementById("totalRiders").textContent = riders.length;

      // update the total count
      const categoryCounts = {};
      riders.forEach((rider) => {
        const category = rider.category;
        categoryCounts[category] = (categoryCounts[category] || 0) + 1;
      });

      
      const labels = Object.keys(categoryCounts);
      const data = Object.values(categoryCounts);

      // renering the data from there to mybar graph
      const ctx = document.getElementById("riderChart").getContext("2d");
      new Chart(ctx, {
        type: "bar", 
        data: {
          labels: labels,
          datasets: [
            {
              label: "Riders per Category",
              data: data,
              backgroundColor: [
                "rgba(54, 162, 235, 0.6)",
                "rgba(255, 99, 132, 0.6)",
                "rgba(255, 206, 86, 0.6)",
                "rgba(75, 192, 192, 0.6)",
                "rgba(153, 102, 255, 0.6)",
              ],
              borderColor: "rgba(0, 0, 0, 0.1)",
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: false,
            },
            title: {
              display: true,
              text: "Rider Distribution by Category",
            },
          },
          options: {
            responsive: true,
            maintainAspectRatio: false, 
            layout: {
              padding: {
                top: 90,
                bottom: 90,
                left: 90,
                right: 90,
                width: 10,
              },
            },
            plugins: {
              legend: {
                display: false,
              },
              title: {
                display: true,
                text: "Rider Distribution by Category",
                font: {
                  size: 14, 
                },
              },
            },
          },
        },
      });
    });
  </script>
</html>
